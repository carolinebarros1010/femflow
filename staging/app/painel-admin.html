<!doctype html>
<html lang="pt-BR">
<head>
  <base href="/staging/app/" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#111114" />
  <link rel="manifest" href="/app/manifest.json" />
  <link rel="icon" href="/app/favicon.ico" />
  <title>FemFlow — Painel PWA</title>
  <style>
    :root {
      color-scheme: dark;
    }
    body {
      font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      margin: 0;
      background: #0f0f10;
      color: #f3f3f3;
    }
    header {
      position: sticky;
      top: 0;
      background: #151518;
      padding: 16px;
      border-bottom: 1px solid #26262b;
      z-index: 2;
    }
    .wrap {
      max-width: 1180px;
      margin: 0 auto;
      padding: 16px;
    }
    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }
    .card {
      background: #151518;
      border: 1px solid #26262b;
      border-radius: 16px;
      padding: 16px;
    }
    .card h2 {
      margin: 0 0 12px;
      font-size: 18px;
    }
    label {
      display: block;
      font-size: 13px;
      color: #b7b7be;
      margin-bottom: 6px;
    }
    input, select, button {
      border-radius: 10px;
      border: 1px solid #2b2b33;
      background: #0f0f10;
      color: #f3f3f3;
      padding: 10px 12px;
      font-size: 14px;
    }
    input, select {
      min-width: 220px;
    }
    button {
      cursor: pointer;
      background: #1f1f25;
    }
    button.primary {
      background: #3d7c71;
      border-color: #3d7c71;
      font-weight: 600;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #2b2b33;
      font-size: 12px;
    }
    .muted {
      color: #b7b7be;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      text-align: left;
      padding: 10px;
      border-bottom: 1px solid #26262b;
      font-size: 13px;
    }
    .status {
      margin-left: auto;
      font-size: 13px;
      color: #9dd6c2;
    }
    @media (max-width: 900px) {
      .row {
        flex-direction: column;
      }
      input, select {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap row" style="align-items:center;justify-content:space-between">
      <div>
        <div style="font-weight:800;font-size:18px">FemFlow — Painel PWA</div>
        <div class="muted">Gestão de alunas, pagamentos e plano.</div>
      </div>
      <div class="pill" id="status">Pronto</div>
    </div>
    <div class="wrap" id="baseWarning" style="display:none">
      <div class="card" style="background:#2b1b1b;border-color:#5f2b2b">
        <strong>Base URL ausente.</strong>
        <span class="muted">Abra este painel via WebApp do Apps Script para carregar as alunas.</span>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="card" style="margin-bottom:16px">
      <h2>Configuração</h2>
      <div class="row" style="align-items:flex-end">
        <div>
          <label for="token">Token admin</label>
          <input id="token" type="password" placeholder="Informe o token de segurança" />
        </div>
        <button id="saveToken">Salvar token</button>
        <div class="status" id="tokenStatus"></div>
      </div>
    </section>

    <section class="card" style="margin-bottom:16px">
      <h2>Nova aluna</h2>
      <div class="row">
        <div>
          <label>Nome</label>
          <input id="newNome" placeholder="Nome completo" />
        </div>
        <div>
          <label>Email</label>
          <input id="newEmail" placeholder="email@dominio.com" />
        </div>
        <div>
          <label>Telefone</label>
          <input id="newTelefone" placeholder="DDD + número" />
        </div>
        <div>
          <label>Produto</label>
          <input id="newProduto" placeholder="premium / vip" />
        </div>
        <div>
          <label>Data compra</label>
          <input id="newDataCompra" type="date" />
        </div>
        <div>
          <label>Licença ativa</label>
          <select id="newLicenca">
            <option value="true">Ativa</option>
            <option value="false">Inativa</option>
          </select>
        </div>
        <div>
          <label>Modo personal</label>
          <select id="newPersonal">
            <option value="false">Desligado</option>
            <option value="true">Ligado</option>
          </select>
        </div>
      </div>
      <div style="margin-top:12px">
        <button class="primary" id="createAluna">Cadastrar nova aluna</button>
      </div>
    </section>

    <section class="card" style="margin-bottom:16px">
      <h2>Buscar / Editar aluna</h2>
      <div class="row" style="align-items:flex-end">
        <div>
          <label>ID ou email</label>
          <input id="searchKey" placeholder="FF-202501-XXXX ou email" />
        </div>
        <button id="buscar">Buscar</button>
      </div>

      <div class="row" style="margin-top:16px">
        <div>
          <label>Nome</label>
          <input id="editNome" />
        </div>
        <div>
          <label>Email</label>
          <input id="editEmail" disabled />
        </div>
        <div>
          <label>Telefone</label>
          <input id="editTelefone" />
        </div>
        <div>
          <label>Produto / Plano</label>
          <input id="editProduto" />
        </div>
        <div>
          <label>Data compra</label>
          <input id="editDataCompra" type="date" />
        </div>
        <div>
          <label>Licença ativa</label>
          <select id="editLicenca">
            <option value="true">Ativa</option>
            <option value="false">Inativa</option>
          </select>
        </div>
        <div>
          <label>Modo personal</label>
          <select id="editPersonal">
            <option value="false">Desligado</option>
            <option value="true">Ligado</option>
          </select>
        </div>
      </div>
      <div style="margin-top:12px">
        <button class="primary" id="salvarEdicao">Salvar alterações</button>
        <span class="muted" id="editStatus"></span>
      </div>
    </section>

    <section class="card">
      <h2>Novas alunas</h2>
      <div class="row" style="align-items:flex-end">
        <div>
          <label>Período (dias)</label>
          <select id="sinceDays">
            <option value="7">Últimos 7 dias</option>
            <option value="14">Últimos 14 dias</option>
            <option value="30">Últimos 30 dias</option>
            <option value="0" selected>Todas</option>
          </select>
        </div>
        <div>
          <label>
            <input id="includeSemData" type="checkbox" checked />
            Incluir sem data de compra
          </label>
        </div>
        <button id="carregarNovas">Carregar</button>
      </div>

      <div style="margin-top:12px;overflow:auto">
        <table>
          <thead>
            <tr>
              <th>Data</th>
              <th>ID</th>
              <th>Nome</th>
              <th>Email</th>
              <th>Produto</th>
              <th>Licença</th>
              <th>Personal</th>
            </tr>
          </thead>
          <tbody id="listaNovas">
            <tr><td colspan="7" class="muted">Sem dados carregados.</td></tr>
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <script>
    const BASE = "https://script.google.com/macros/s/AKfycbz-XlzsxRzYCHz-Ri2CYR2aRb7jyZenQD-04Po_Qgu0Vc6KWuSXBnAPla4EBDJT5qEU/exec";
    window.FEMFLOW_ADMIN_BASE = BASE;
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/app/service-worker.js");
    }
  </script>
  <script src="/app/js/painel-admin.js"></script>
</body>
</html>
